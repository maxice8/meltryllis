#!/bin/sh

if [ -e "$BSPWM_STATE" ]; then
	bspc wm -l "$BSPWM_STATE"
	rm -f -- "$BSPWM_STATE"
fi

bspc monitor -d 1 2 3 4 5 6 7 8 9

bspc config border_width 0

bspc config pointer_follows_focus true

# Make all windows floating
bspc rule -a "*" state=floating

# Main browser and its download window
bspc rule -a Firefox:Navigator desktop=^1 rectangle=1366x733+0+35 follow=on
bspc rule -a Firefox:SessionManager desktop=^1 layer=above

# Messenger
bspc rule -a TelegramDesktop:telegram-desktop desktop=^2 rectangle=1366x733+0+35 follow=on

# Imageboard downloader.
bspc rule -a Grabber:Grabber desktop=^4 rectangle=1366x733+0+35 follow=on

# Secondary browser.
bspc rule -a '*:chromium' desktop=^4 rectangle=1366x733+0+35 follow=on

# Imageboard downloader.
bspc rule -a '*:claws-mail' desktop=^5 rectangle=1366x733+0+35 follow=on

# Adopt orphans
bspc wm -o

pgrep -u "$(id -u)" -x polybar && pkill -u "$(id -u)" -x polybar

polybar main --reload
