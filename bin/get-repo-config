#!/usr/bin/ion
test $len(@args) -eq 1 && exit 1

fn username
	git config --get user.name
end

fn remote_url
	if git config --get remote.upstream.url >/dev/null
		git config --get remote.upstream.url
		return 0
	end

	if git config --get remote.origin.url >/dev/null
		git config --get remote.origin.url
		return 0
	end
end

fn repo_name
	echo $basename($regex_replace($(remote_url) '.git$' ' '))
end

fn repo_owner
	echo $basename($parent($(remote_url)))
end

fn origin_remote_url
	git config --get remote.origin.url >/dev/null || return $?

	git config --get remote.origin.url
end

fn origin_repo_name
	echo $basename($regex_replace($(origin_remote_url) '.git$' ' '))
end

fn origin_repo_owner
	let origin_remote_url = $(origin_remote_url)
	if starts-with $origin_remote_url 'git@'
		echo $parent(@split($origin_remote_url :))
	else
		echo $basename($parent($origin_remote_url))
	end
end

for opt in @args[1..]
	match $opt
		case username
			username
		case repo-name
			repo_name
		case repo-owner
			repo_owner
		case origin-repo-name
			origin_repo_name
		case origin-repo-owner
			origin_repo_owner
	end
end
